(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{oSGn:function(e,t,r){"use strict";r.r(t);var n=r("VTBJ"),a=(r("qVdP"),r("jsC+")),c=(r("lUTK"),r("BvKs")),u=(r("2qtc"),r("kLXV")),i=(r("+L6B"),r("2/Rp")),o=(r("/zsF"),r("PArb")),s=r("ODXe"),l=r("o0o1"),p=r.n(l),f=(r("miYZ"),r("tsqr")),d=r("HaE+"),b=r("xvlK"),v=r("8Skl"),m=r("q1tI"),O=r.n(m),h=r("Hx5s"),x=r("Qiat"),j=r("9kvl"),w=r("sy1d"),y=r("kS/g"),k=r("wx14"),g=r("FVvW"),E=r("4X1l"),C={labelCol:{span:5},wrapperCol:{span:15}};Object(E["a"])();var T=Object(g["createFormActions"])(),S=function(e){var t=e.modalVisible,r=e.onSubmit,a=e.onCancel,c=e.initVals,i=Object(m["useState"])([]),o=Object(s["a"])(i,2),l=o[0],f=o[1],b=Object(m["useState"])(""),v=Object(s["a"])(b,2),h=v[0],x=v[1];function j(e){var t=l.findIndex((function(t){return t.type===e}));if(t>-1){var r=l[t].urlPrefix,n=r.endsWith("/")?r:"".concat(r,"/");return x(n),n}return x(""),""}var E=c?{groupType:c.groupType,desc:c.desc}:{},S=Object(g["useForm"])({value:E,actions:T}),P={type:"object",properties:{groupType:{type:"string",title:"\u5206\u7ec4\u7c7b\u578b",required:!0,enum:l.map((function(e){return{value:e.type,label:e.label}})),"x-component-props":{allowClear:!0,onChange:function(e){j(e)}}},desc:{type:"string",title:"\u5206\u7ec4\u63cf\u8ff0",required:!0},urlPrefix:{type:"string",title:"URL\u524d\u7f00",required:!0,"x-component-props":{addonBefore:h}}}};Object(m["useEffect"])((function(){return Object(y["c"])().then((function(e){w["a"].isOk(e)&&f(e.data)})),function(){Object(w["b"])()}}),[]),Object(m["useEffect"])((function(){if(c&&c.groupType&&c.urlPrefix){var e=j(c.groupType);e&&""!==e&&T.setFieldValue("urlPrefix",c.urlPrefix.replace(e,""))}return function(){}}),[l]);var I=function(){var e=Object(d["a"])(p.a.mark((function e(){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.validate();case 3:return e.next=5,S.submit(function(){var e=Object(d["a"])(p.a.mark((function e(t){var a;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r(Object(n["a"])(Object(n["a"])({},t),{},{urlPrefix:h+t.urlPrefix}));case 2:a=e.sent,a&&S.reset();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return O.a.createElement(u["a"],{maskClosable:!1,destroyOnClose:!0,visible:t,title:c?"\u590d\u5236\u5206\u7ec4":"\u521b\u5efa\u5206\u7ec4",onOk:I,onCancel:function(){S.reset(),a()}},O.a.createElement(g["default"],Object(k["a"])({schema:P,form:S},C)))},P={labelCol:{span:5},wrapperCol:{span:15}};Object(E["a"])();var I=Object(g["createFormActions"])(),V=function(e){var t=e.modalVisible,r=e.onSubmit,a=e.onCancel,c=e.initVals,i=Object(m["useState"])([]),o=Object(s["a"])(i,2),l=o[0],f=o[1],b=Object(m["useState"])(""),v=Object(s["a"])(b,2),h=v[0],x=v[1];function j(e){var t=l.findIndex((function(t){return t.type===e}));if(t>-1){var r=l[t].urlPrefix,n=r.endsWith("/")?r:"".concat(r,"/");return x(n),n}return x(""),""}var E=c?{groupType:c.groupType,desc:c.desc}:{},C=Object(g["useForm"])({value:E,actions:I}),T={type:"object",properties:{groupType:{type:"string",title:"\u5206\u7ec4\u7c7b\u578b",required:!0,enum:l.map((function(e){return{value:e.type,label:e.label}})),"x-component-props":{allowClear:!0,onChange:function(e){j(e)}}},desc:{type:"string",title:"\u5206\u7ec4\u63cf\u8ff0",required:!0},urlPrefix:{type:"string",title:"URL\u524d\u7f00",required:!0,"x-component-props":{addonBefore:h}}}};Object(m["useEffect"])((function(){return Object(y["c"])().then((function(e){w["a"].isOk(e)&&f(e.data)})),function(){Object(w["b"])()}}),[]),Object(m["useEffect"])((function(){if(c&&c.groupType&&c.urlPrefix){var e=j(c.groupType);e&&""!==e&&I.setFieldValue("urlPrefix",c.urlPrefix.replace(e,""))}return function(){}}),[l]);var S=function(){var e=Object(d["a"])(p.a.mark((function e(){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.validate();case 3:return e.next=5,C.submit(function(){var e=Object(d["a"])(p.a.mark((function e(t){var a;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r(Object(n["a"])(Object(n["a"])({},t),{},{urlPrefix:h+t.urlPrefix,id:c.id}));case 2:a=e.sent,a&&C.reset();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return O.a.createElement(u["a"],{maskClosable:!1,destroyOnClose:!0,visible:t,title:"\u7f16\u8f91\u5206\u7ec4",onOk:S,onCancel:function(){C.reset(),a()}},O.a.createElement(g["default"],Object(k["a"])({schema:T,form:C},P)))},q=function(){var e=Object(d["a"])(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=f["a"].loading("\u6b63\u5728\u6dfb\u52a0"),e.prev=1,e.next=4,Object(y["a"])(t);case 4:if(n=e.sent,r(),!w["a"].isOk(n)){e.next=9;break}return f["a"].success("\u6dfb\u52a0\u6210\u529f"),e.abrupt("return",!0);case 9:return f["a"].warn(n.msg),e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e["catch"](1),r(),f["a"].error("\u6dfb\u52a0\u5931\u8d25\u8bf7\u91cd\u8bd5\uff01"),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(d["a"])(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=f["a"].loading("\u6b63\u5728\u66f4\u65b0"),e.prev=1,e.next=4,Object(y["f"])(t);case 4:if(n=e.sent,r(),!w["a"].isOk(n)){e.next=9;break}return f["a"].success("\u66f4\u65b0\u6210\u529f"),e.abrupt("return",!0);case 9:return f["a"].warn(n.msg),e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e["catch"](1),r(),f["a"].error("\u66f4\u65b0\u5931\u8d25\u8bf7\u91cd\u8bd5\uff01"),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(d["a"])(p.a.mark((function e(t){var r,n;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=f["a"].loading("\u6b63\u5728\u5220\u9664"),t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,Object(y["e"])(t.map((function(e){return e.id})));case 6:if(n=e.sent,r(),!n||0!==n.code){e.next=11;break}return f["a"].success("\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u5237\u65b0"),e.abrupt("return",!0);case 11:return f["a"].warn(n.msg),e.abrupt("return",!1);case 15:return e.prev=15,e.t0=e["catch"](3),r(),f["a"].error("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(m["useState"])(!1),t=Object(s["a"])(e,2),r=t[0],l=t[1],f=Object(m["useState"])(!1),k=Object(s["a"])(f,2),g=k[0],E=k[1],C=Object(m["useState"])(void 0),T=Object(s["a"])(C,2),P=T[0],I=T[1],R=Object(m["useState"])({}),B=Object(s["a"])(R,2),K=B[0],L=B[1],U=Object(m["useRef"])(),J=[{title:"\u5e8f\u53f7",dataIndex:"id",valueType:"indexBorder",width:64},{title:"\u5206\u7ec4\u7c7b\u578b",dataIndex:"groupType",valueEnum:K,formItemProps:{allowClear:!0}},{title:"\u5206\u7ec4\u63cf\u8ff0",dataIndex:"desc",hideInSearch:!0},{title:"URL\u524d\u7f00",dataIndex:"urlPrefix",hideInSearch:!0},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",valueType:"dateRange",hideInForm:!0},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updatedAt",hideInSearch:!0,hideInForm:!0},{title:"\u64cd\u4f5c",dataIndex:"option",valueType:"option",render:function(e,t){return O.a.createElement(O.a.Fragment,null,O.a.createElement("a",{onClick:function(){E(!0),I(t)}},"\u7f16\u8f91"),O.a.createElement(o["a"],{type:"vertical"}),O.a.createElement("a",{onClick:function(){I(t),l(!0)}},"\u590d\u5236"),O.a.createElement(o["a"],{type:"vertical"}),O.a.createElement("a",{onClick:function(){j["e"].push("/system/dataway/".concat(t.id,"/apilist"))}},"\u63a5\u53e3\u5217\u8868"))}}];return Object(m["useEffect"])((function(){return Object(y["c"])().then((function(e){if(w["a"].isOk(e)){var t={};e.data.forEach((function(e){t[e.type]={text:e.label}})),L(t)}})),function(){Object(w["b"])()}}),[]),O.a.createElement(h["c"],{title:"\u5206\u7ec4\u7ba1\u7406"},O.a.createElement(x["a"],{headerTitle:"\u5206\u7ec4\u5217\u8868",actionRef:U,rowKey:"id",toolBarRender:function(e,t){var r=t.selectedRows;return[O.a.createElement(i["a"],{icon:O.a.createElement(b["a"],null),type:"primary",onClick:function(){I(void 0),l(!0)}},"\u65b0\u5efa"),r&&r.length>0&&O.a.createElement(a["a"],{overlay:O.a.createElement(c["a"],{onClick:function(){var t=Object(d["a"])(p.a.mark((function t(n){return p.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"remove"===n.key&&u["a"].confirm({title:"\u5220\u9664\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e9b\u5b57\u5178?",onOk:function(){A(r).then((function(){e.reload()}))}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),selectedKeys:[]},O.a.createElement(c["a"].Item,{key:"remove"},"\u6279\u91cf\u5220\u9664"))},O.a.createElement(i["a"],null,"\u6279\u91cf\u64cd\u4f5c ",O.a.createElement(v["a"],null)))]},request:function(){var e=Object(d["a"])(p.a.mark((function e(t){var r,a;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Object(n["a"])({},t),r.createdAt&&(r.createdAt=t.createdAt.map((function(e){return e.split(" ")[0]})),r.createdAt[0]+=" 00:00:00",r.createdAt[1]+=" 23:59:59"),e.next=4,Object(y["d"])(r);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),columns:J,rowSelection:{}}),r&&O.a.createElement(S,{initVals:P,modalVisible:r,onSubmit:function(){var e=Object(d["a"])(p.a.mark((function e(t){var r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q(t);case 2:return r=e.sent,r&&(I(void 0),setTimeout((function(){l(!1),U.current&&U.current.reload()}),0)),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onCancel:function(){I(void 0),setTimeout((function(){l(!1)}),0)}}),g&&O.a.createElement(V,{initVals:P,modalVisible:g,onSubmit:function(){var e=Object(d["a"])(p.a.mark((function e(t){var r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return r=e.sent,r&&(E(!1),U.current&&U.current.reload()),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onCancel:function(){I(void 0),setTimeout((function(){E(!1)}),0)}}))};t["default"]=R}}]);
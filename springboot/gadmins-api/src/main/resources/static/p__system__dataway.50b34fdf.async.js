(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{oSGn:function(e,t,n){"use strict";n.r(t);var r=n("VTBJ"),a=(n("qVdP"),n("jsC+")),c=(n("lUTK"),n("BvKs")),u=(n("2qtc"),n("kLXV")),i=(n("+L6B"),n("2/Rp")),o=(n("/zsF"),n("PArb")),l=n("ODXe"),s=n("o0o1"),p=n.n(s),d=(n("miYZ"),n("tsqr")),f=n("HaE+"),b=n("q1tI"),m=n.n(b),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 757.4h-53.8c-4.2 0-7.7 3.5-7.7 7.7v61.8H197.1V197.1h629.8v61.8c0 4.2 3.5 7.7 7.7 7.7h53.8c4.2 0 7.7-3.4 7.7-7.7V158.7c0-17-13.7-30.7-30.7-30.7H158.7c-17 0-30.7 13.7-30.7 30.7v706.6c0 17 13.7 30.7 30.7 30.7h706.6c17 0 30.7-13.7 30.7-30.7V765.1c0-4.3-3.5-7.7-7.7-7.7zM902 476H588v-76c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-76h314c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"import",theme:"outlined"},h=v,y=n("6VBw"),x=function(e,t){return b["createElement"](y["a"],Object.assign({},e,{ref:t,icon:h}))};x.displayName="ImportOutlined";var w=b["forwardRef"](x),O=n("xvlK"),j=n("8Skl"),k=n("Hx5s"),g=n("Qiat"),E=n("9kvl"),C=n("sy1d"),I=n("kS/g"),S=n("wx14"),T=n("FVvW"),V={labelCol:{span:5},wrapperCol:{span:15}},P=Object(T["createFormActions"])(),q=function(e){var t=e.modalVisible,n=e.onSubmit,a=e.onCancel,c=e.initVals,i=Object(b["useState"])([]),o=Object(l["a"])(i,2),s=o[0],d=o[1],v=Object(b["useState"])(""),h=Object(l["a"])(v,2),y=h[0],x=h[1];function w(e){var t=s.findIndex((function(t){return t.type===e}));if(t>-1){var n=s[t].urlPrefix,r=n.endsWith("/")?n:"".concat(n,"/");return x(r),r}return x(""),""}var O=c?{groupType:c.groupType,desc:c.desc}:{},j={type:"object",properties:{groupType:{type:"string",title:"\u5206\u7ec4\u7c7b\u578b",required:!0,enum:s.map((function(e){return{value:e.type,label:e.label}})),"x-component-props":{allowClear:!0,onChange:function(e){w(e)}}},desc:{type:"string",title:"\u5206\u7ec4\u63cf\u8ff0",required:!0},urlPrefix:{type:"string",title:"URL\u524d\u7f00",required:!0,"x-component-props":{addonBefore:y}},hasMenu:{type:"boolean",title:"\u83dc\u5355","x-linkages":[{type:"value:visible",target:"menuCode",condition:"{{$value}}"},{type:"value:visible",target:"menuParentCode",condition:"{{$value}}"},{type:"value:visible",target:"menuTitle",condition:"{{$value}}"}]},menuCode:{type:"string",title:"\u83dc\u5355\u7f16\u7801",required:!0},menuParentCode:{type:"string",title:"\u83dc\u5355\u7236\u7ea7\u7f16\u7801",required:!0},menuTitle:{type:"string",title:"\u83dc\u5355\u6807\u9898",required:!0}}};Object(b["useEffect"])((function(){return Object(I["c"])().then((function(e){C["a"].isOk(e)&&d(e.data)})),function(){Object(C["b"])()}}),[]),Object(b["useEffect"])((function(){if(c&&c.groupType&&c.urlPrefix){var e=w(c.groupType);e&&""!==e&&P.setFieldValue("urlPrefix",c.urlPrefix.replace(e,""))}return function(){}}),[s]);var k=function(){var e=Object(f["a"])(p.a.mark((function e(){return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.validate();case 3:return e.next=5,P.submit(function(){var e=Object(f["a"])(p.a.mark((function e(t){var a;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n(Object(r["a"])(Object(r["a"])({},t),{},{urlPrefix:y+t.urlPrefix,id:c.id}));case 2:a=e.sent,a&&P.reset();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return m.a.createElement(u["a"],{maskClosable:!1,destroyOnClose:!0,visible:t,title:"\u7f16\u8f91\u5206\u7ec4",onOk:k,onCancel:function(){P.reset(),a()}},m.a.createElement(T["default"],Object(S["a"])({initialValues:O,schema:j,actions:P},V)))},A=m.a.lazy((function(){return n.e(1).then(n.bind(null,"ulAy"))})),R=function(){var e=Object(f["a"])(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=d["a"].loading("\u6b63\u5728\u6dfb\u52a0"),e.prev=1,e.next=4,Object(I["a"])(t);case 4:if(r=e.sent,n(),!C["a"].isOk(r)){e.next=9;break}return d["a"].success("\u6dfb\u52a0\u6210\u529f"),e.abrupt("return",!0);case 9:return d["a"].warn(r.msg),e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e["catch"](1),n(),d["a"].error("\u6dfb\u52a0\u5931\u8d25\u8bf7\u91cd\u8bd5\uff01"),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(f["a"])(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=d["a"].loading("\u6b63\u5728\u66f4\u65b0"),e.prev=1,e.next=4,Object(I["f"])(t);case 4:if(r=e.sent,n(),!C["a"].isOk(r)){e.next=9;break}return d["a"].success("\u66f4\u65b0\u6210\u529f"),e.abrupt("return",!0);case 9:return d["a"].warn(r.msg),e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e["catch"](1),n(),d["a"].error("\u66f4\u65b0\u5931\u8d25\u8bf7\u91cd\u8bd5\uff01"),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(f["a"])(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=d["a"].loading("\u6b63\u5728\u5220\u9664"),t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,Object(I["e"])(t.map((function(e){return e.id})));case 6:if(r=e.sent,n(),!r||0!==r.code){e.next=11;break}return d["a"].success("\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u5237\u65b0"),e.abrupt("return",!0);case 11:return d["a"].warn(r.msg),e.abrupt("return",!1);case 15:return e.prev=15,e.t0=e["catch"](3),n(),d["a"].error("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(b["useState"])(!1),t=Object(l["a"])(e,2),n=t[0],s=t[1],d=Object(b["useState"])(!1),v=Object(l["a"])(d,2),h=v[0],y=v[1],x=Object(b["useState"])(void 0),S=Object(l["a"])(x,2),T=S[0],V=S[1],P=Object(b["useState"])({}),H=Object(l["a"])(P,2),K=H[0],z=H[1],L=Object(b["useRef"])(),J=[{title:"\u5e8f\u53f7",dataIndex:"id",valueType:"indexBorder",width:64},{title:"\u5206\u7ec4\u7c7b\u578b",dataIndex:"groupType",valueEnum:K,formItemProps:{allowClear:!0}},{title:"\u5206\u7ec4\u63cf\u8ff0",dataIndex:"desc",hideInSearch:!0},{title:"URL\u524d\u7f00",dataIndex:"urlPrefix",hideInSearch:!0},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdAt",valueType:"dateRange",hideInForm:!0},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"updatedAt",hideInSearch:!0,hideInForm:!0},{title:"\u64cd\u4f5c",dataIndex:"option",valueType:"option",render:function(e,t){return m.a.createElement(m.a.Fragment,null,m.a.createElement("a",{onClick:function(){y(!0),V(t)}},"\u7f16\u8f91"),m.a.createElement(o["a"],{type:"vertical"}),m.a.createElement("a",{onClick:function(){V(t),s(!0)}},"\u590d\u5236"),m.a.createElement(o["a"],{type:"vertical"}),m.a.createElement("a",{onClick:function(){E["e"].push("/system/dataway/".concat(t.id,"/apilist"))}},"\u63a5\u53e3\u5217\u8868"))}}];return Object(b["useEffect"])((function(){return Object(I["c"])().then((function(e){if(C["a"].isOk(e)){var t={};e.data.forEach((function(e){t[e.type]={text:e.label}})),z(t)}})),function(){Object(C["b"])()}}),[]),m.a.createElement(k["c"],{title:"\u5206\u7ec4\u7ba1\u7406"},m.a.createElement(g["a"],{headerTitle:"\u5206\u7ec4\u5217\u8868",actionRef:L,rowKey:"id",toolBarRender:function(e,t){var n=t.selectedRows;return[m.a.createElement(i["a"],{icon:m.a.createElement(w,null),type:"primary",onClick:function(){}},"\u5bfc\u5165"),m.a.createElement(i["a"],{icon:m.a.createElement(O["a"],null),type:"primary",onClick:function(){V(void 0),s(!0)}},"\u65b0\u5efa"),n&&n.length>0&&m.a.createElement(a["a"],{overlay:m.a.createElement(c["a"],{onClick:function(){var t=Object(f["a"])(p.a.mark((function t(r){return p.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:"remove"===r.key&&u["a"].confirm({title:"\u5220\u9664\u63d0\u793a",content:"\u786e\u5b9a\u8981\u5220\u9664\u60a8\u6240\u9009\u7684\u5185\u5bb9?",onOk:function(){F(n).then((function(){e.reload()}))}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),selectedKeys:[]},m.a.createElement(c["a"].Item,{key:"remove"},"\u6279\u91cf\u5220\u9664"),m.a.createElement(c["a"].Item,{key:"export"},"\u6279\u91cf\u5bfc\u51fa"))},m.a.createElement(i["a"],null,"\u6279\u91cf\u64cd\u4f5c ",m.a.createElement(j["a"],null)))]},request:function(){var e=Object(f["a"])(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(r["a"])({},t),n.createdAt&&(n.createdAt=t.createdAt.map((function(e){return e.split(" ")[0]})),n.createdAt[0]+=" 00:00:00",n.createdAt[1]+=" 23:59:59"),e.next=4,Object(I["d"])(n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),columns:J,rowSelection:{}}),n&&m.a.createElement(b["Suspense"],{fallback:!0},m.a.createElement(A,{initVals:T,modalVisible:n,onSubmit:function(){var e=Object(f["a"])(p.a.mark((function e(t){var n;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,R(t);case 2:return n=e.sent,n&&(V(void 0),setTimeout((function(){s(!1),L.current&&L.current.reload()}),0)),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onCancel:function(){V(void 0),setTimeout((function(){s(!1)}),0)}})),h&&m.a.createElement(q,{initVals:T,modalVisible:h,onSubmit:function(){var e=Object(f["a"])(p.a.mark((function e(t){var n;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,B(t);case 2:return n=e.sent,n&&(y(!1),L.current&&L.current.reload()),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onCancel:function(){V(void 0),setTimeout((function(){y(!1)}),0)}}))};t["default"]=H}}]);